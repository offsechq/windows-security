# Check if Admin-Privileges are available
function Test-IsAdmin {
    ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")
}

if (Test-IsAdmin) {
    $xmlPath = Join-Path $PSScriptRoot "exploit-protection-reset.xml"
    Set-ProcessMitigation -PolicyFilePath $xmlPath
    Write-Host "Exploit protection settings applied successfully." -ForegroundColor Green
} else {
    Write-Host "Please run as administrator" -ForegroundColor Red
    exit 1
}